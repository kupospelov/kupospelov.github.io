<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>My unoriginal approach to manage dotfiles - Konstantin Pospelov</title><link rel=stylesheet href=/style.css type=text/css media=all><link rel=icon type=image/jpg href=/img/me.jpg></head><body><nav class=menu><a class=menu-item href=/>about</a>
<a class="menu-item current" href=/blog/>blog</a><hr></nav><main><article><time pubdate=pubdate>Jun 23, 2020</time><h1>My unoriginal approach to manage dotfiles</h1><p>After I had to set up a few machines this year, I finally realized that I should have a tool to version and quickly restore my configuration files. This post is about what I came up with.</p><p>My <code>$HOME</code> is a git repository similar to one described in the <a href=https://drewdevault.com/2019/12/30/dotfiles.html>post</a> by Drew DeVault. I like this approach, because there is no need in symlinks and git is a nice and familiar tool to use. My setup is a little bit different though.</p><p>In fact, my <code>$HOME</code> contains two git repositories: one for general-purpose public dotfiles and one for private dotfiles. I do this by specifying <code>--git-dir</code> and <code>--work-tree</code>, inspired by <a href=https://www.atlassian.com/git/tutorials/dotfiles>this article</a>. For convenience, I created two different shell aliases for these commands.</p><p>The general-purpose part defines the file structure and can be shared in a public <a href=https://git.sr.ht/~kupospelov/dotfiles>repository</a>. This is the place to store the files for <em>all</em> my machines. This is also almost everything that I need on my personal ones.</p><p>The private part contains files that are specific to the organization I am working at, and that is the reason to store them in a separate private repository. This repository can generally have more than one branch to store files for different machine types.</p><p>I find storing machine-specific configuration in git a bit cumbersome, so parameters like output scale or touchpad sensitivity are not versioned. My dotfiles contain so few such files that I do not care if I have to recreate them manually at some point.</p><p>The tricky thing is to refactor the configuration files to split them into public and private ones. There is no one-fits-all solution to this problem. Ideally, you would want to use <code>config.d</code> directories to store the pieces that are different, but this may not always be possible. In <code>.bashrc</code>, I use a simple <code>for</code> loop which iterates over all files in <code>~/.bashrc.d</code> and sources them. In the case of sway, the <code>include</code> command makes it possible to put some pieces of the configuration outside of the main config file.</p><p>In the end, restoring a complete configuration in this setup boils down to cloning the shared dotfiles and the proper private branch, and then to optional per-device customizations.</p></article></main><footer><hr><p>The content is licensed under <a rel=license href=http://creativecommons.org/licenses/by/4.0/>CC BY 4.0</a>.</p><br></footer></body></html>